<UserControl x:Class="Foodbook.Presentation.Views.Tabs.RecipesView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d">
    <StackPanel>
        <Border Background="White" CornerRadius="20" Padding="32" Margin="0,0,0,24">
            <Border.Effect>
                <DropShadowEffect Color="#4CAF50" Direction="270" ShadowDepth="8" Opacity="0.15" BlurRadius="20"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                        <Border Background="#4CAF50" CornerRadius="12" Padding="8" Margin="0,0,16,0" Height="48">
                            <TextBlock Text="🍽️" FontSize="24" Foreground="White"/>
                        </Border>
                        <StackPanel>
                            <TextBlock Text="My Recipe Collection" FontSize="36" FontWeight="Bold" Foreground="#1F2937"/>
                            <TextBlock Text="Discover, create, and manage your culinary masterpieces" FontSize="16" Foreground="#6B7280" Margin="0,4,0,0"/>
                        </StackPanel>
                    </StackPanel>
                    <Grid Margin="0,8,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Background="#E8F5E8" CornerRadius="8" Padding="12,8" Margin="0,0,12,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📚" FontSize="14" Margin="0,0,6,0"/>
                                <TextBlock Text="{Binding Recipes.Count, StringFormat={}{0}}" FontSize="16" FontWeight="Bold" Foreground="#4CAF50"/>
                                <TextBlock Text=" recipes" FontSize="14" Foreground="#6B7280" Margin="4,0,0,0"/>
                            </StackPanel>
                        </Border>
                        <Border Grid.Column="1" Background="#FFF3E0" CornerRadius="8" Padding="12,8" Margin="0,0,12,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="⭐" FontSize="14" Margin="0,0,6,0"/>
                                <TextBlock Text="{Binding MyAverageCookTime, StringFormat={}{0:F0}}" FontSize="16" FontWeight="Bold" Foreground="#FF9800"/>
                                <TextBlock Text=" avg min" FontSize="14" Foreground="#6B7280" Margin="4,0,0,0"/>
                            </StackPanel>
                        </Border>
                        <Border Grid.Column="2" Background="#E3F2FD" CornerRadius="8" Padding="12,8" Margin="0,0,12,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="🔥" FontSize="14" Margin="0,0,6,0"/>
                                <TextBlock Text="{Binding MyMostCommonDifficulty}" FontSize="16" FontWeight="Bold" Foreground="#2196F3"/>
                            </StackPanel>
                        </Border>
                        <Border Grid.Column="3" Background="#F3E5F5" CornerRadius="8" Padding="12,8">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="🤖" FontSize="14" Margin="0,0,6,0"/>
                                <TextBlock Text="{Binding MyAIGeneratedRecipes}" FontSize="16" FontWeight="Bold" Foreground="#9C27B0"/>
                                <TextBlock Text=" AI recipes" FontSize="14" Foreground="#6B7280" Margin="4,0,0,0"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </StackPanel>
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Top">
                    <Button Background="#4CAF50" Foreground="White" FontSize="14" FontWeight="SemiBold" Padding="24,16" BorderThickness="0" Margin="0,0,12,0" Command="{Binding AnalyzePantryCommand}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="🤖" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Analyze Pantry (AI Chef)"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>
                    <Button Background="#4CAF50" Foreground="White" FontSize="14" FontWeight="SemiBold" Padding="24,16" BorderThickness="0" Margin="0,0,12,0" Command="{Binding AddRecipeCommand}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="➕" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Add Recipe"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>
                    <Button Background="#8B5CF6" Foreground="White" FontSize="14" FontWeight="SemiBold" Padding="24,16" BorderThickness="0" Command="{Binding ViewRecipeAnalyticsCommand}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📊" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Analytics"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <Border Background="White" CornerRadius="20" Padding="32" Margin="0,0,0,24">
            <Border.Effect>
                <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="4" Opacity="0.08" BlurRadius="16"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Border Grid.Row="0" Background="#F8FAFC" CornerRadius="16" Padding="20,16" Margin="0,0,0,20">
                    <Grid>
                        <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" Background="Transparent" BorderThickness="0" FontSize="16" VerticalAlignment="Center" Padding="0,0,50,0"/>
                        <TextBlock Text="🔍 Search recipes, ingredients, or cooking methods..." Foreground="#9CA3AF" FontSize="16" VerticalAlignment="Center" IsHitTestVisible="False" Margin="0,0,50,0">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SearchText}" Value="">
                                            <Setter Property="Visibility" Value="Visible"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding SearchText}" Value="{x:Null}">
                                            <Setter Property="Visibility" Value="Visible"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                        <Button Background="#4CAF50" Foreground="White" Width="36" Height="34" FontSize="16" BorderThickness="0" HorizontalAlignment="Right" Command="{Binding SearchRecipesCommand}">
                            <TextBlock Text="🔍"/>
                        </Button>
                    </Grid>
                </Border>
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <ScrollViewer Grid.Column="0" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Disabled">
                        <StackPanel Orientation="Horizontal">
                            <Border Padding="16,10" Margin="0,0,8,0" CornerRadius="20" Background="#4CAF50" Cursor="Hand">
                                <Border.InputBindings>
                                    <MouseBinding Gesture="LeftClick" Command="{Binding FilterByCategoryCommand}" CommandParameter="All"/>
                                </Border.InputBindings>
                                <TextBlock Text="{Binding Recipes.Count, StringFormat={}All ({0})}" Foreground="White" FontWeight="SemiBold" FontSize="14"/>
                            </Border>
                            <Border Padding="16,10" Margin="0,0,8,0" CornerRadius="20" Background="#F1F5F9" Cursor="Hand">
                                <Border.InputBindings>
                                    <MouseBinding Gesture="LeftClick" Command="{Binding FilterByCategoryCommand}" CommandParameter="Main Dishes"/>
                                </Border.InputBindings>
                                <TextBlock Text="🍽️ Main Dishes" Foreground="#374151" FontWeight="Medium" FontSize="14"/>
                            </Border>
                            <Border Padding="16,10" Margin="0,0,8,0" CornerRadius="20" Background="#F1F5F9" Cursor="Hand">
                                <Border.InputBindings>
                                    <MouseBinding Gesture="LeftClick" Command="{Binding FilterByCategoryCommand}" CommandParameter="Desserts"/>
                                </Border.InputBindings>
                                <TextBlock Text="🍰 Desserts" Foreground="#374151" FontWeight="Medium" FontSize="14"/>
                            </Border>
                            <Border Padding="16,10" Margin="0,0,8,0" CornerRadius="20" Background="#F1F5F9" Cursor="Hand">
                                <Border.InputBindings>
                                    <MouseBinding Gesture="LeftClick" Command="{Binding FilterByCategoryCommand}" CommandParameter="Quick"/>
                                </Border.InputBindings>
                                <TextBlock Text="⚡ Quick Recipes" Foreground="#374151" FontWeight="Medium" FontSize="14"/>
                            </Border>
                            <Border Padding="16,10" Margin="0,0,8,0" CornerRadius="20" Background="#F1F5F9" Cursor="Hand">
                                <Border.InputBindings>
                                    <MouseBinding Gesture="LeftClick" Command="{Binding FilterByCategoryCommand}" CommandParameter="Healthy"/>
                                </Border.InputBindings>
                                <TextBlock Text="🥗 Healthy" Foreground="#374151" FontWeight="Medium" FontSize="14"/>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                    <Border Grid.Column="1" Background="#F8FAFC" CornerRadius="12" Padding="16,12">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Sort by:" FontSize="14" Foreground="#6B7280" VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <ComboBox SelectedItem="{Binding SortBy}" Width="160" Height="34" FontSize="14" Background="White" BorderThickness="0">
                                <ComboBoxItem Content="📝 Name A-Z" IsSelected="True"/>
                                <ComboBoxItem Content="📝 Name Z-A"/>
                                <ComboBoxItem Content="⏱️ Time (Low to High)"/>
                                <ComboBoxItem Content="⏱️ Time (High to Low)"/>
                                <ComboBoxItem Content="🔥 Difficulty (Easy to Hard)"/>
                                <ComboBoxItem Content="🔥 Difficulty (Hard to Easy)"/>
                                <ComboBoxItem Content="📅 Date Created"/>
                            </ComboBox>
                        </StackPanel>
                    </Border>
                </Grid>
            </Grid>
        </Border>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <ItemsControl Grid.Row="0" ItemsSource="{Binding PagedRecipes}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel Margin="0,0,0,24" ItemWidth="360" ItemHeight="Auto"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Background="White" CornerRadius="16" Padding="12" Margin="8" Cursor="Hand" MinWidth="340" MaxWidth="360">
                            <Border.Effect>
                                <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="4" Opacity="0.08" BlurRadius="14"/>
                            </Border.Effect>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Border Grid.Column="0" CornerRadius="12" Background="#F8FAFC" Width="120" Height="120">
                                    <Grid>
                                        <Image Source="{Binding ImageUrl, Converter={StaticResource ImageUrlConverter}}" Stretch="UniformToFill"/>
                                        <TextBlock Text="🍽️" FontSize="32" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="#9CA3AF" Visibility="{Binding ImageUrl, Converter={StaticResource NullToVisibilityConverter}}"/>
                                    </Grid>
                                </Border>
                                <StackPanel Grid.Column="1" Margin="12,0,0,0">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding Title}" FontSize="16" FontWeight="SemiBold" Foreground="#111827" TextWrapping="Wrap"/>
                                        <Border Background="#4CAF50" CornerRadius="10" Padding="6,2" Margin="8,0,0,0" Visibility="{Binding Category, Converter={StaticResource NullToVisibilityConverter}, ConverterParameter=Invert}">
                                            <TextBlock Text="{Binding Category}" FontSize="11" Foreground="White"/>
                                        </Border>
                                        <Border Background="#FF9800" CornerRadius="10" Padding="6,2" Margin="6,0,0,0">
                                            <TextBlock Text="{Binding Difficulty, Converter={StaticResource StringCleanConverter}}" FontSize="11" Foreground="White"/>
                                        </Border>
                                    </StackPanel>
                                    <TextBlock Text="{Binding Description}" FontSize="12" Foreground="#6B7280" TextWrapping="Wrap" MaxHeight="36" Margin="0,4,0,6"/>
                                    <StackPanel Orientation="Horizontal">
                                        <StackPanel Orientation="Horizontal" Margin="0,0,8,0">
                                            <TextBlock Text="⏱️" Margin="0,0,4,0"/>
                                            <TextBlock Text="{Binding CookTime, StringFormat={}{0}m}" Foreground="#374151"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="8,0,0,0">
                                            <TextBlock Text="⭐" Margin="0,0,4,0"/>
                                            <TextBlock Text="{Binding Ratings, Converter={StaticResource CountToWidthConverter}}" Visibility="Collapsed"/>
                                            <TextBlock Text="{Binding Ratings.Count, StringFormat={}{0} reviews}" Foreground="#374151"/>
                                        </StackPanel>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                        <Button Background="#4CAF50" Foreground="White" FontSize="12" Padding="10,6" BorderThickness="0" Command="{Binding DataContext.ViewRecipeCommand, RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}" Margin="0,0,6,0">
                                            <TextBlock Text="View"/>
                                        </Button>
                                        <Button Background="#6B7280" Foreground="White" FontSize="12" Padding="10,6" BorderThickness="0" Command="{Binding DataContext.EditRecipeCommand, RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}">
                                            <TextBlock Text="Edit"/>
                                        </Button>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,8,0,0">
                <Button Style="{StaticResource PaginationButton}" Content="◄" Command="{Binding DataContext.PrevPageCommand, RelativeSource={RelativeSource AncestorType=Window}}" Margin="4,0"/>
                <Border Background="White" CornerRadius="8" Padding="8,4" Margin="8,0" BorderBrush="{DynamicResource DividerBrush}" BorderThickness="1">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="Page" Foreground="#6B7280" Margin="0,0,6,0"/>
                        <ComboBox Width="72" Height="28" ItemsSource="{Binding PageOptions}" SelectedItem="{Binding SelectedPage, Mode=TwoWay}" BorderThickness="0" Background="Transparent"/>
                        <TextBlock Text="/" Foreground="#6B7280" Margin="6,0"/>
                        <TextBlock Text="{Binding TotalPages}"/>
                    </StackPanel>
                </Border>
                <Button Style="{StaticResource PaginationButton}" Content="►" Command="{Binding DataContext.NextPageCommand, RelativeSource={RelativeSource AncestorType=Window}}" Margin="4,0"/>
            </StackPanel>
        </Grid>

        <Border Background="White" CornerRadius="20" Padding="60" Margin="0,40,0,0" Visibility="{Binding Recipes.Count, Converter={StaticResource BooleanToVisibilityConverter}}">
            <Border.Effect>
                <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="4" Opacity="0.08" BlurRadius="16"/>
            </Border.Effect>
            <StackPanel HorizontalAlignment="Center">
                <Border Background="#F8FAFC" CornerRadius="50" Padding="30" Margin="0,0,0,24">
                    <TextBlock Text="🍽️" FontSize="72" HorizontalAlignment="Center"/>
                </Border>
                <TextBlock Text="No recipes yet" FontSize="28" FontWeight="Bold" Foreground="#1F2937" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                <TextBlock Text="Start building your culinary collection! Add your first recipe to get started." FontSize="16" Foreground="#6B7280" HorizontalAlignment="Center" TextWrapping="Wrap" TextAlignment="Center" Margin="0,0,0,32"/>
                <Button Background="#4CAF50" Foreground="White" FontSize="16" FontWeight="SemiBold" Padding="32,16" BorderThickness="0" Command="{Binding AddRecipeCommand}">
                    <Button.Content>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="➕" FontSize="18" Margin="0,0,8,0"/>
                            <TextBlock Text="Add Your First Recipe"/>
                        </StackPanel>
                    </Button.Content>
                </Button>
            </StackPanel>
        </Border>
    </StackPanel>
</UserControl>


